tinymce.create("tinymce.plugins.Multipage",{init:function(e,t){e.addButton("subpage",{tooltip:e.getLang("multipage_tinymce_plugin.new_subpage"),cmd:"subpage",image:""}),e.addCommand("subpage",function(){e.windowManager.open({title:e.getLang("multipage_tinymce_plugin.enter_subpage_title"),body:[{type:"textbox",name:"title",label:"Title",value:""}],onsubmit:function(t){void 0!==t.data.title&&t.data.title.length&&(shortcode='[nextpage title="'+t.data.title+'"]<br />'),e.execCommand("mceInsertContent",0,shortcode)}})}),e.on("BeforeSetContent",function(e){e.content&&-1!==e.content.indexOf('[nextpage title="')&&(e.content=e.content.replace(/\[nextpage title=\"(.*?)\"\]/g,function(e,t){return'<img src="'+tinymce.Env.transparentSrc+'" data-wp-more="subpage" class="wp-more-tag mce-wp-subpage" title="'+t+'" data-mce-resize="false" data-mce-placeholder="1" />'}))}),e.on("PostProcess",function(e){e.get&&(e.content=e.content.replace(/<img[^>]+>/g,function(e){var t,n="";return-1!==e.indexOf('data-wp-more="subpage"')&&((t=e.match(/title="([^"]+)"/))&&(n=t[1]),e='[nextpage title="'+n+'"]'),e}))})}}),tinymce.PluginManager.add("multipage",tinymce.plugins.Multipage);